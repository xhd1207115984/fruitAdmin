(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-404dd0b5"],{"44b0":function(e,t,r){},"7c7d":function(e,t,r){},"89e33":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"product-detail"},[r("a-steps",{staticClass:"product-steps",attrs:{current:e.current}},e._l(e.steps,(function(e){return r("a-step",{key:e.title,attrs:{title:e.title}})})),1),r("div",{staticClass:"steps-content"},[0===e.current?r("basic-detail",{attrs:{form:e.form},on:{next:e.next}}):e._e(),1===e.current?r("sale-detail",{attrs:{form:e.form},on:{next:e.next,prev:e.prev}}):e._e()],1)],1)},n=[],i=r("5530"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"basic-detail"},[r("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":{span:5},"wrapper-col":{span:13}}},[r("a-form-model-item",{attrs:{label:"标题",prop:"title",required:""}},[r("a-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),r("a-form-model-item",{attrs:{label:"商品描述",prop:"desc"}},[r("a-input",{model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),r("a-form-model-item",{attrs:{label:"商品类目",required:"",prop:"category"}},[r("a-select",{attrs:{placeholder:"请选择商品类目"},on:{change:e.changeCategory},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categoryList,(function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),r("a-select",{attrs:{placeholder:"请添加子类目"},model:{value:e.form.c_item,callback:function(t){e.$set(e.form,"c_item",t)},expression:"form.c_item"}},e._l(e.categoryItems,(function(t){return r("a-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"商品标签",prop:"tags",required:""}},[r("a-select",{attrs:{mode:"tags",placeholder:"Please select","default-value":["包邮，最晚次日达"]},model:{value:e.form.tags,callback:function(t){e.$set(e.form,"tags",t)},expression:"form.tags"}},[r("a-select-option",{attrs:{value:"包邮，最晚次日达"}},[e._v(" "+e._s("包邮，最晚次日达")+" ")])],1)],1),r("a-form-model-item",{staticClass:"next-btn",attrs:{warpperCol:{span:24}}},[r("a-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")])],1)],1)],1)},s=[],c=(r("96cf"),r("1da1")),l=r("c405"),u={props:["form"],data:function(){return{rules:{},categoryList:[],categoryItems:[]}},methods:{changeCategory:function(e){for(var t=0;t<this.categoryList.length;t+=1)this.categoryList[t].id===e&&(this.categoryItems=this.categoryList[t].c_items)},next:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=3;break}return e.$emit("next",e.form),t.abrupt("return",!0);case 3:return window.console.log("error submit!!"),t.abrupt("return",!1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},created:function(){var e=this;Object(l["a"])().then((function(t){e.categoryList=t.data}))}},f=u,m=(r("9b18"),r("2877")),p=Object(m["a"])(f,o,s,!1,null,null,null),d=p.exports,v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"sale-detail"},[r("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":{span:5},"wrapper-col":{span:13}}},[r("a-form-model-item",{attrs:{label:"商品售价",prop:"price",required:""}},[r("a-input",{model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),r("a-form-model-item",{attrs:{label:"折扣价格",prop:"price_off"}},[r("a-input",{model:{value:e.form.price_off,callback:function(t){e.$set(e.form,"price_off",t)},expression:"form.price_off"}})],1),r("a-form-model-item",{attrs:{label:"库存信息",prop:"inventory",required:""}},[r("a-input",{model:{value:e.form.inventory,callback:function(t){e.$set(e.form,"inventory",t)},expression:"form.inventory"}})],1),r("a-form-model-item",{attrs:{label:"计量单位",prop:"unit",required:""}},[r("a-input",{model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit",t)},expression:"form.unit"}})],1),r("a-form-model-item",{attrs:{label:"商品相册",prop:"images",required:""}},[r("a-upload",{attrs:{action:"https://mallapi.duyiedu.com/upload/images?appkey="+e.$store.state.user.appkey,"list-type":"picture-card","file-list":e.fileList,name:"avatar"},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<8?r("div",[r("a-icon",{attrs:{type:!0===e.loading?"loading":"plus"}}),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e(),r("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)],1),r("a-form-model-item",{staticClass:"prev-btn",attrs:{warpperCol:{span:24}}},[r("a-button",{attrs:{type:"default"},on:{click:e.prev}},[e._v("上一步")]),r("a-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("提交")])],1)],1)],1)},h=[];r("4de4"),r("d81d"),r("d3b7");function b(e){return new Promise((function(t,r){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return r(e)}}))}var g={props:["form"],data:function(){return{rules:{},fileList:[],loading:!1,previewVisible:!1,previewImage:""}},methods:{handlePreview:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e,e.url||e.preview){r.next=5;break}return r.next=4,b(e.originFileObj);case 4:a.preview=r.sent;case 5:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 7:case"end":return r.stop()}}),r)})))()},handleChange:function(e){var t=e.file,r=e.fileList;if(window.console.log(r),this.fileList=r,"done"===t.status)this.form.images.push(t.response.data.url);else if("removed"===t.status){var a=t.response.data.url;this.form.images=this.form.images.filter((function(e){return e!==a}))}},prev:function(){this.$emit("prev")},next:function(e){var t=this;this.$refs.ruleForm.validate(function(){var r=Object(c["a"])(regeneratorRuntime.mark((function r(a){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a){r.next=3;break}return t.$emit("next",e),r.abrupt("return",!0);case 3:return window.console.log("error submit!!"),r.abrupt("return",!1);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},handleCancel:function(){this.previewVisible=!1}},created:function(){this.form.images.length>0&&(this.fileList=this.form.images.map((function(e,t){return{uid:t,name:"image".concat(t,".png"),status:"done",url:e}})))}},w=g,y=Object(m["a"])(w,v,h,!1,null,null,null),x=y.exports,_=r("c4c8"),k={data:function(){return{current:0,form:{title:"",desc:"",category:"",c_items:"",tags:[],price:0,price_off:0,unit:"",inventory:0,images:[]},steps:[{title:"填写商品基本信息"},{title:"填写商品销售信息"}]}},components:{basicDetail:d,saleDetail:x},methods:{next:function(e){var t=this;this.form=Object(i["a"])(Object(i["a"])({},this.form),{},{form:e}),1===this.current&&(this.$route.params.id?_["a"].edit(this.form).then((function(){t.$message.success("修改成功"),t.$router.push({name:"ProductList"})})):_["a"].add(this.form).then((function(e){window.console.log(e),t.$message.success("新增成功"),t.$router.push({name:"ProductList"})}))),this.current+=1},prev:function(){this.current-=1}},created:function(){var e=this,t=this.$route.params.id;t&&_["a"].detail(t).then((function(t){window.console.log(t),e.form=t}))}},$=k,C=(r("a1bd"),Object(m["a"])($,a,n,!1,null,"f687f2aa",null));t["default"]=C.exports},"9b18":function(e,t,r){"use strict";r("7c7d")},a1bd:function(e,t,r){"use strict";r("44b0")},c405:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r("bb36");function n(e){return a["a"].get("/category/all",{params:e})}},c4c8:function(e,t,r){"use strict";var a=r("bb36");t["a"]={list:function(e){return a["a"].get("/products/all",{params:e})},remove:function(e){return a["a"].delete("/products/".concat(e.id))},add:function(e){return a["a"].post("/products/add",e)},detail:function(e){return a["a"].get("/products/".concat(e))},edit:function(e){return a["a"].put("/products/edit",e)}}}}]);
//# sourceMappingURL=chunk-404dd0b5.53c23134.js.map